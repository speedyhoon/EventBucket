<!DOCTYPE html>
<html>
<head>
<style>
body{
	-webkit-user-select: none;
}
body.night{
	background: #000;
	color: #ccc;
	border-color: #ccc;
}
.notification div{
	width: 20px;
	height: 20px;
    display: inline-block;
	border-width: 1px;
	border-style: solid;
	cursor: pointer;
}
#revs{
	/*background: #707;
	height: 3px;*/
	background: red;
    width: 3px;
    height: 100px;
    -webkit-transform: rotate(2210deg);
    -webkit-transform-origin: bottom;
	margin: 90px;
}


#hibeam.on{
	background: #07f;
}
#oil.on, #water.on{
	background: #f00;
}
#left.on, #right.on{
	background: #070;
}
#handbrake.on{
	background: #f70;
}
</style>
</head>
<body>
<h1>Websocket Dashboard Example</h1>
Speed: <b id=speed>0</b>km/h
<br>
<div id=revs></div>
<br>
Fuel Tank: <b id=fuel>0</b>%
<br>
Fuel Consumption: <b id=mpg>0</b>mpg <b id=lp100>0</b>L/100km
<br>
Odometer: <b id=odom>0</b>km
<br>
<div class=notification>
High Beam: <div id=hibeam onclick="lights(id)"></div>
<br>
Left Turn: <div id=left onclick="onoff(id)"></div>
<br>
Right Turn: <div id=right onclick="onoff(id)"></div>
<br>
Oil Warning: <div id=oil></div>
<br>
Water Warning: <div id=water></div>
<br>
Handbrake Warning: <div id=handbrake></div>
<br>
</div>
<script>
var ws = new WebSocket("ws://10.1.1.5:4000/websocket/ws");
ws.onopen = function()
     {
        ws.send("connect");
     };
ws.onmessage = function (event) {
	var data = JSON.parse(event.data);
	for (variable in data) {
		switcher(variable, data[variable]);
	}
}
function switcher(variable, value){
	switch(variable){
		case "revs":
			setSvg(variable, value);
			break;
		case "speed":
		case "fuel":
		case "mpg":
		case "lp100":
		case "odom":
			setValue(variable, value);
			break;
		case "left":
		case "right":
		case "hibeam":
		case "oil":
		case "water":
		case "handbrake":
			display(variable, value);
			break;
	}
}
function setSvg(id, value){
	//document.getElementById(id).style.width = value+"px";
	document.getElementById("revs").style.webkitTransform = "rotate("+(value-90)+"deg)";
}
function setValue(id, value){
	document.getElementById(id).innerHTML = value;
}
function display(id, value){
	document.getElementById(id).className = value ? "" : "on";
}
function lights(id){
	onoff(id);
	document.body.className = document.body.className ? "" : "night";
}
function onoff(id){
	ws.send(id);
	display(id, document.getElementById(id).className ? true : false);
}
</script>
</body></html>