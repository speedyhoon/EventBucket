{{define "page"}}
	{{template "EventDetails" .EventDetails}}
	{{if.Event.Closed}}
		<samp>Event is closed, no changes can be made.</samp>
	{{else}}
		{{template "AddRange" .AddRange}}
		{{with.RangeDataList}}
			<datalist id=r>
				{{range.}}
					<option>{{.Name}}
				{{end}}
			</datalist>
		{{end}}
		{{if ge (len.Ranges) 2}}
			{{template "AddAggregateRange" .AddAgg}}
		{{end}}
	{{end}}
	{{range.UpdateErrors}}<samp>{{.}}</samp>{{end}}
	{{with.Event.Ranges}}
		<p>Total Ranges: {{len.}}
		{{/*TODO investigate shortening conditional classes e.g.: <table{{ifnot$.event.closed}} data-s{{end}}> */}}
		{{if not $.Event.Closed}}
			<table id=editRow>
		{{else}}
			<table>
		{{end}}
			<thead>
				<th class=asc>ID
				<th>Range
				<th>Aggs
				<td>Locked
				{{if not $.Event.Closed}}
					<td>Edit
				{{end}}
			<tbody>
			{{range.}}
				<tr>
					<td>{{.ID}}
					<td>{{.Name}}
{{/*TODO investigate shortening conditional classes e.g.: 
<td>{{range.Aggs}}{{(findRange.$.Event.Ranges).Name}}, {{end}}
<td{{ifand.locked(not.isagg)}} class=tick{{end}}>
*/}}
					<td>
						{{if.IsAgg}}
							{{range.Aggs}}{{(findRange . $.Event.Ranges).Name}}, {{end}}
						{{end}}
					{{if and .Locked (not .IsAgg)}}
						<td class=tick>
					{{else}}
						<td>
					{{end}}
					{{if not $.Event.Closed}}
						<td>
					{{end}}
			{{end}}
		</table>
	{{else}}
		<samp>This event has no ranges.</samp>
	{{end}}

	{{if and (not $.Event.Closed) .Event.Ranges}}
		<template>
			<td></td>
{{/* Are closing td tags required? */}}
			<td>
				<input required name=n maxlength=64 list=r type=search placeholder="Range name" form=editRow>
				<span onclick=moveRange class="^arrows^ ^desc^" title="Move Up"></span>
				<span onclick=moveRange class="^arrows^ ^asc^" title="Move Down"></span>
			</td>
			<td>
				<select size={{len.Ranges}} required name=R multiple form=editRow>
					{{template "optionList" .Ranges}}
				</select>
			</td>
			<td>
				<input name=k type=checkbox form=editRow>
			</td>
			<td>
				<form method=post action=/20 id=editRow>
					<button name=I>Save</button>
					<input type=hidden name=E value={{.Event.ID}}>
					<input type=hidden name=o>
				</form>
			</td>
		</template>
		<script defer src=dirJS/eventRanges></script>
		<script defer src=dirJS/editRow></script>
	{{end}}
{{end}}