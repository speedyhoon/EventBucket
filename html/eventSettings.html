{{define "page"}}
	{{template "EventDetails" .EventDetails}}
	{{if.Event.Closed}}
		<samp>Event is closed, no changes can be made.</samp>
	{{else}}
		{{template "AddRange" .AddRange}}
		{{with.RangeDataList}}
			<datalist id=r>
				{{range.}}
					<option>{{.}}
				{{end}}
			</datalist>
		{{end}}
		{{if ge (len .Ranges) 2}}
			{{template "AddAggregateRange" .AddAgg}}
		{{end}}
	{{end}}
	{{range.UpdateErrors}}<samp>{{.}}</samp>{{end}}
	{{with.Event.Ranges}}
		<p>Total Ranges: {{len .}}
        <table{{a " data-s" (not $.Event.Closed)}}>
			<thead>
				<th class=asc>ID
				<th>Range
				<th>Aggs
				<td>Locked
				{{if not $.Event.Closed}}
					<td>Edit
				{{end}}
			<tbody>
				{{range.}}
					<tr>
						<td>{{.ID}}
						<td>{{.Name}}
						<td>{{range.Aggs}}{{(findRange . $.Event.Ranges).Name}}, {{end}}
						<td{{a " class=tick" (and .Locked (not .IsAgg))}}>
						{{if not $.Event.Closed}}
							<td>
						{{end}}
				{{end}}
		</table>
	{{else}}
		<samp>This event has no ranges.</samp>
	{{end}}

	{{if and (not $.Event.Closed) .Event.Ranges}}
		<template>
			<td>
			<td>
				<input required name=n maxlength=64 list=r type=search placeholder="Range name" form=editRow>
				<span onclick=moveRange class="^arrows^ ^desc^" title="Move Up"></span>
				<span onclick=moveRange class="^arrows^ ^asc^" title="Move Down"></span>
			<td>
				<select size={{len .Ranges}} required name=R multiple form=editRow>
					{{template "optionList" .Ranges}}
				</select>
			<td>
				<input name=k type=checkbox form=editRow>
			<td>
				<form method=post action=/20 id=editRow>
					<button name=I>Save</button>
					<input type=hidden name=E value={{.Event.ID}}>
					<input type=hidden name=o>
				</form>
		</template>
		<script defer src=/j/eventRanges></script>
		<script defer src=/j/editRow></script>
	{{end}}
{{end}}